name: kevin-build-task-app
services:
  #Our PostgreSQL database
  db:
    #The Docker image of postgres -- we're using the latest.
    image: postgres:16
    #The ports to expose to the host container
    #5432 is the default PostgreSQL port
    ports:
      - "5432:5432"

    #If we accidentally kill the running contaier, Docker compose
    #will restart it
    restart: always

    #The PostgreSQL Docker container uses environment variables to
    #read configuration, here we set the password.
    #Do not store plaintest passwords! This is just the builder.
    environment:
      POSTGRES_PASSWORD: changemeinprod!
      POSTGRES_USER: postgres
      POSTGRES_DB: tasks

  #Our frontend service
  ui:
  # The UI Docker image, hosted on GitHub.
    image: kevkimutai/task-tracker-app-ui:latest
    ports:
      # Make the UI available on http:^/localhost:5173
      - "5173:5173"
    # Tell the UI how to find your Spring Boot app.
    environment:
      - VITE_API_URL=http://host.docker.internal:8080
    # For Linux compatibility
    extra_hosts:
      - "host.docker.internal:host-gateway"